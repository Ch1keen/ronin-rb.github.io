<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Ronin PostEx Documentation
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><h1 id="ronin-post_ex">ronin-post_ex</h1>

<p><a href="https://github.com/ronin-rb/ronin-post_ex/actions/workflows/ruby.yml"><img src="https://github.com/ronin-rb/ronin-post_ex/actions/workflows/ruby.yml/badge.svg" alt="CI"></a>
<a href="https://codeclimate.com/github/ronin-rb/ronin-post_ex"><img src="https://codeclimate.com/github/ronin-rb/ronin-post_ex.svg" alt="Code Climate"></a></p>

<ul>
<li><a href="https://ronin-rb.dev/">Website</a></li>
<li><a href="https://github.com/ronin-rb/ronin-post_ex">Source</a></li>
<li><a href="https://github.com/ronin-rb/ronin-post_ex/issues">Issues</a></li>
<li><a href="https://ronin-rb.dev/docs/ronin-post_ex/frames">Documentation</a></li>
<li><a href="https://discord.gg/6WAb3PsVX9">Discord</a> |
<a href="https://twitter.com/ronin_rb">Twitter</a> |
<a href="https://infosec.exchange/@ronin_rb">Mastodon</a></li>
</ul>

<h2 id="description">Description</h2>

<p>ronin-post_ex is a Ruby API for Post-Exploitation.</p>

<p>This library is used by <a href="https://github.com/ronin-rb/ronin-payloads#readme">ronin-payloads</a>, <a href="https://github.com/ronin-rb/ronin-c2#readme">ronin-c2</a>, and <a href="https://github.com/ronin-rb/ronin-exploits#readme">ronin-exploits</a>
to provide a Post-Exploitation API around payloads, C2 sessions, or even
exploits.</p>

<p>ronin-post_ex is part of the <a href="https://ronin-rb.dev">ronin-rb</a> project, a <a href="https://www.ruby-lang.org">Ruby</a> toolkit for security
research and development.</p>

<h2 id="features">Features</h2>

<ul>
<li>Defines a syscall-like <a href="https://github.com/ronin-rb/ronin-post_ex/blob/main/API_SPEC.md">API for Post-Exploitation</a>.</li>
<li>Provides classes for interacting with the Post-Exploitation API.

<ul>
<li><span class='object_link'><a href="Ronin/PostEx/System.html" title="Ronin::PostEx::System (class)">Ronin::PostEx::System</a></span> - allows interacting with a remote system.</li>
<li><span class='object_link'><a href="Ronin/PostEx/System/FS.html" title="Ronin::PostEx::System::FS (class)">Ronin::PostEx::System::FS</a></span> - allows interacting with the file-system.</li>
<li><span class='object_link'><a href="Ronin/PostEx/System/Process.html" title="Ronin::PostEx::System::Process (class)">Ronin::PostEx::System::Process</a></span> - allows manipulating the current process
or child processes.</li>
<li><span class='object_link'><a href="Ronin/PostEx/System/Shell.html" title="Ronin::PostEx::System::Shell (class)">Ronin::PostEx::System::Shell</a></span> - allows interacting with an interactive
shell..</li>
<li><span class='object_link'><a href="Ronin/PostEx/RemoteFile.html" title="Ronin::PostEx::RemoteFile (class)">Ronin::PostEx::RemoteFile</a></span> - allows reading/writing files.</li>
<li><span class='object_link'><a href="Ronin/PostEx/RemoteDir.html" title="Ronin::PostEx::RemoteDir (class)">Ronin::PostEx::RemoteDir</a></span> - allows reading the contents of directories.</li>
<li><span class='object_link'><a href="Ronin/PostEx/RemoteProcess.html" title="Ronin::PostEx::RemoteProcess (class)">Ronin::PostEx::RemoteProcess</a></span> - allows reading/writing to an running
command.</li>
</ul></li>
<li>Supports interacting with interactive shell commands.</li>
<li>Provides interactive command shells for interacting with systems.</li>
<li>Supports Linux/BSD/UNIX systems.</li>
<li>Provides common post-exploitation session classes for interacting with shells,
bind shells, and reverse shells.</li>
<li>Supports defining custom post-exploitation session classes.</li>
</ul>

<h2 id="limitations">Limitations</h2>

<ul>
<li>Does not currently support Windows systems.</li>
<li>Does not fully support bidirectional fully interactive shell commands.</li>
</ul>

<h2 id="examples">Examples</h2>

<h3 id="bind-shell">Bind Shell</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_session'>session</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/PostEx.html" title="Ronin::PostEx (module)">PostEx</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/PostEx/Sessions.html" title="Ronin::PostEx::Sessions (module)">Sessions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/PostEx/Sessions/BindShell.html" title="Ronin::PostEx::Sessions::BindShell (class)">BindShell</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connect'><span class='object_link'><a href="Ronin/PostEx/Sessions/BindShell.html#connect-class_method" title="Ronin::PostEx::Sessions::BindShell.connect (method)">connect</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span><span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span>
<span class='id identifier rubyid_system'>system</span>  <span class='op'>=</span> <span class='id identifier rubyid_session'>session</span><span class='period'>.</span><span class='id identifier rubyid_system'>system</span>

<span class='id identifier rubyid_system'>system</span><span class='period'>.</span><span class='id identifier rubyid_shell'>shell</span><span class='period'>.</span><span class='id identifier rubyid_ls'>ls</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; &quot;...&quot;
</span></code></pre>

<h3 id="reverse-shell">Reverse Shell</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_session'>session</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/PostEx.html" title="Ronin::PostEx (module)">PostEx</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/PostEx/Sessions.html" title="Ronin::PostEx::Sessions (module)">Sessions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/PostEx/Sessions/ReverseShell.html" title="Ronin::PostEx::Sessions::ReverseShell (class)">ReverseShell</a></span></span><span class='period'>.</span><span class='id identifier rubyid_listen'><span class='object_link'><a href="Ronin/PostEx/Sessions/ReverseShell.html#listen-class_method" title="Ronin::PostEx::Sessions::ReverseShell.listen (method)">listen</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span><span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span>
<span class='id identifier rubyid_system'>system</span>  <span class='op'>=</span> <span class='id identifier rubyid_session'>session</span><span class='period'>.</span><span class='id identifier rubyid_system'>system</span>

<span class='id identifier rubyid_system'>system</span><span class='period'>.</span><span class='id identifier rubyid_shell'>shell</span><span class='period'>.</span><span class='id identifier rubyid_ls'>ls</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; &quot;...&quot;
</span></code></pre>

<h3 id="custom-session-class">Custom Session Class</h3>

<p>Define a custom session class which defines the
<a href="https://github.com/ronin-rb/ronin-post_ex/blob/main/API_SPEC.md">Post-Exploitation API methods</a>:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>RATSession</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="Ronin.html" title="Ronin (module)">Ronin</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/PostEx.html" title="Ronin::PostEx (module)">PostEx</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/PostEx/Sessions.html" title="Ronin::PostEx::Sessions (module)">Sessions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Ronin/PostEx/Sessions/Session.html" title="Ronin::PostEx::Sessions::Session (class)">Session</a></span></span>

  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span><span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span>
    <span class='comment'># ...
</span>  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_rpc_call'>rpc_call</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='comma'>,</span><span class='op'>*</span><span class='id identifier rubyid_arguments'>arguments</span><span class='rparen'>)</span>
    <span class='comment'># ...
</span>  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_fs_read'>fs_read</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_rpc_call'>rpc_call</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fs_read</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_shell_exec'>shell_exec</span><span class='lparen'>(</span><span class='id identifier rubyid_command'>command</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_rpc_call'>rpc_call</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>shell_exec</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='id identifier rubyid_command'>command</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># ...
</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_session'>session</span> <span class='op'>=</span> <span class='const'>RATSession</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_system'>system</span>  <span class='op'>=</span> <span class='id identifier rubyid_session'>session</span><span class='period'>.</span><span class='id identifier rubyid_system'>system</span>
</code></pre>

<h3 id="system">System</h3>

<p>Interact with the system&#39;s remote files as if they were local files:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='id identifier rubyid_system'>system</span><span class='period'>.</span><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/etc/passwd</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_each_line'>each_line</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
  <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_uid'>uid</span><span class='comma'>,</span> <span class='id identifier rubyid_gid'>gid</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_home_dir'>home_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_shell'>shell</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>User Detected: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_user'>user</span><span class='embexpr_end'>}</span><span class='tstring_content'> (id=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_uid'>uid</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</code></pre>

<p>Get information about the current process:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_system'>system</span><span class='period'>.</span><span class='id identifier rubyid_process'>process</span><span class='period'>.</span><span class='id identifier rubyid_pid'>pid</span>
<span class='comment'># =&gt; 1234
</span>
<span class='id identifier rubyid_system'>system</span><span class='period'>.</span><span class='id identifier rubyid_process'>process</span><span class='period'>.</span><span class='id identifier rubyid_getuid'>getuid</span>
<span class='comment'># =&gt; 1001
</span>
<span class='id identifier rubyid_system'>system</span><span class='period'>.</span><span class='id identifier rubyid_process'>process</span><span class='period'>.</span><span class='id identifier rubyid_environ'>environ</span>
<span class='comment'># =&gt; {&quot;HOME&quot;=&gt;&quot;...&quot;, &quot;PATH&quot;=&gt;&quot;...&quot;, ...}
</span></code></pre>

<p>Execute commands on the remote system:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_system'>system</span><span class='period'>.</span><span class='id identifier rubyid_shell'>shell</span><span class='period'>.</span><span class='id identifier rubyid_ls'>ls</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; &quot;bin\nboot\ndev\netc\nhome\nlib\nlib64\nlost+found\nmedia\nmnt\nopt\nproc\nroot\nrun\nsbin\nsnap\nsrv\nsys\ntmp\nusr\nvar\n&quot;
</span>
<span class='id identifier rubyid_system'>system</span><span class='period'>.</span><span class='id identifier rubyid_shell'>shell</span><span class='period'>.</span><span class='id identifier rubyid_exec'>exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>find -type f -name &#39;*.xls&#39; /srv</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_path'>path</span><span class='op'>|</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Found XLS file: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</code></pre>

<p>Spawn an interactive command shell:</p>

<pre class="code ruby"><code class="ruby">system.shell.interact
$
</code></pre>

<p>Spawn an interactive post-exploitation system shell:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_system'>system</span><span class='period'>.</span><span class='id identifier rubyid_interact'>interact</span>
</code></pre>

<pre class="code ruby"><code class="ruby">ronin-post_ex&gt; help
  help [COMMAND]                    Prints the list of commands or additional help
  fs.chdir DIR                      Changes the current working directory
  fs.pwd                            Prints the current working directory
  fs.readfile FILE                  Reads the contents of a given FILE
  fs.readlink SYMLINK               Reads the destination path of a symlink
  fs.readdir DIR                    Reads the contents of a given directory
  fs.hexdump FILE                   Hexdumps a given file
  fs.copy SRC DEST                  Copies the SRC file to the DEST path
  fs.unlink FILE                    Deletes a given file
  fs.rmdir DIR                      Removes a given directory
  fs.mv SRC DEST                    Moves or renames a given file or directory
  fs.link SRC DEST                  Creates a link from the source to the destination
  fs.chown USER PATH                Changes the owner of a given file or directory
  fs.chgrp GROUP PATH               Changes the group of a given file or directory
  fs.chmod MODE PATH                Changes the permission mode of a given file or directory
  fs.stat PATH                      Prints file system information about a given file or directory
  fs.open PATH [MODE]               Opens a file for reading or writing
  files                             Lists opened files
  file.seek FILE_ID POS [WHENCE]    Seeks to a position within the file
  file.read FILE_ID LENGTH          Reads LENGTH of data from an opened file
  file.write FILE_ID DATA           Writes data to an opened file
  file.close FILE_ID                Closes an open file
ronin-post_ex&gt; 
</code></pre>

<h2 id="requirements">Requirements</h2>

<ul>
<li><a href="https://www.ruby-lang.org">Ruby</a> &gt;= 3.0.0</li>
<li><a href="https://github.com/postmodern/fake_io.rb#readme">fake_io</a> ~&gt; 0.1</li>
<li><a href="https://github.com/postmodern/hexdump.rb#readme">hexdump</a> ~&gt; 1.0</li>
<li><a href="https://github.com/ronin-rb/ronin-core#readme">ronin-core</a> ~&gt; 0.1</li>
</ul>

<h2 id="install">Install</h2>

<pre class="code shell"><code class="shell">$ gem install ronin-post_ex
</code></pre>

<h3 id="gemfile">Gemfile</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ronin-post_ex</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~&gt; 0.1</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<h3 id="gemspec">gemspec</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span><span class='period'>.</span><span class='id identifier rubyid_add_dependency'>add_dependency</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ronin-post_ex</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~&gt; 0.1</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<h2 id="development">Development</h2>

<ol>
<li><a href="https://github.com/ronin-rb/ronin-post_ex/fork">Fork It!</a></li>
<li>Clone It!</li>
<li><code>cd ronin-post_ex/</code></li>
<li><code>bundle install</code></li>
<li><code>git checkout -b my_feature</code></li>
<li>Code It!</li>
<li><code>bundle exec rake spec</code></li>
<li><code>git push origin my_feature</code></li>
</ol>

<h2 id="license">License</h2>

<p>Copyright (c) 2007-2023 Hal Brodigan (postmodern.mod3 at gmail.com)</p>

<p>ronin-post_ex is free software: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>

<p>ronin-post_ex is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.</p>

<p>You should have received a copy of the GNU Lesser General Public License
along with ronin-post_ex.  If not, see <a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>.</p>
</div></div>

      <div id="footer">
  Generated on Sun Jan  1 18:23:58 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.28 (ruby-3.1.3).
</div>

    </div>
  </body>
</html>