<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Ronin::Exploits::CLI::ExploitShell
  
    &mdash; Ronin::Exploits Documentation
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Ronin::Exploits::CLI::ExploitShell";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (E)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Ronin.html" title="Ronin (module)">Ronin</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Exploits.html" title="Ronin::Exploits (module)">Exploits</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../CLI.html" title="Ronin::Exploits::CLI (class)">CLI</a></span></span>
     &raquo; 
    <span class="title">ExploitShell</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Ronin::Exploits::CLI::ExploitShell
  
  
  <span class="private note title">Private</span>
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Core::CLI::CommandShell</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Core::CLI::CommandShell</li>
          
            <li class="next">Ronin::Exploits::CLI::ExploitShell</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd>CommandKit::Colors</dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/ronin/exploits/cli/exploit_shell.rb</dd>
  </dl>
  
</div>

<div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This class is part of a private API.</strong>
  You should avoid using this class if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="ARCHES-constant" class="">ARCHES =
          <div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This constant is part of a private API.</strong>
  You should avoid using this constant if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Core</span><span class='op'>::</span><span class='const'>CLI</span><span class='op'>::</span><span class='const'>Options</span><span class='op'>::</span><span class='const'>Values</span><span class='op'>::</span><span class='const'>ARCHES</span></pre></dd>
      
        <dt id="OSES-constant" class="">OSES =
          <div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This constant is part of a private API.</strong>
  You should avoid using this constant if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Core</span><span class='op'>::</span><span class='const'>CLI</span><span class='op'>::</span><span class='const'>Options</span><span class='op'>::</span><span class='const'>Values</span><span class='op'>::</span><span class='const'>OSES</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#list-instance_method" title="#list (instance method)">#<strong>list</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#param_name_completion-instance_method" title="#param_name_completion (instance method)">#<strong>param_name_completion</strong>(klass)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#param_value_completion-instance_method" title="#param_value_completion (instance method)">#<strong>param_value_completion</strong>(klass, param_name)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload-instance_method" title="#payload (instance method)">#<strong>payload</strong>(payload_name)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_completion-instance_method" title="#payload_completion (instance method)">#<strong>payload_completion</strong>(arg, preposing)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#run-instance_method" title="#run (instance method)">#<strong>run</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set-instance_method" title="#set (instance method)">#<strong>set</strong>(name, value)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_completion-instance_method" title="#set_completion (instance method)">#<strong>set_completion</strong>(arg, preposing)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#target-instance_method" title="#target (instance method)">#<strong>target</strong>(*args)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#target_completion-instance_method" title="#target_completion (instance method)">#<strong>target_completion</strong>(arg, preposing)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test-instance_method" title="#test (instance method)">#<strong>test</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#use-instance_method" title="#use (instance method)">#<strong>use</strong>(exploit_name)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#use_completion-instance_method" title="#use_completion (instance method)">#<strong>use_completion</strong>(arg, preposing)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="list-instance_method">
  
    #<strong>list</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/exploits/cli/exploit_shell.rb', line 50</span>

<span class='kw'>def</span> <span class='id identifier rubyid_list'>list</span>
  <span class='const'><span class='object_link'><a href="../../Exploits.html" title="Ronin::Exploits (module)">Exploits</a></span></span><span class='period'>.</span><span class='id identifier rubyid_list_files'>list_files</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file'>file</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="param_name_completion-instance_method">
  
    #<strong>param_name_completion</strong>(klass)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


156
157
158</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/exploits/cli/exploit_shell.rb', line 156</span>

<span class='kw'>def</span> <span class='id identifier rubyid_param_name_completion'>param_name_completion</span><span class='lparen'>(</span><span class='id identifier rubyid_klass'>klass</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="param_value_completion-instance_method">
  
    #<strong>param_value_completion</strong>(klass, param_name)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


141
142
143
144
145
146
147
148
149
150
151
152
153
154</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/exploits/cli/exploit_shell.rb', line 141</span>

<span class='kw'>def</span> <span class='id identifier rubyid_param_value_completion'>param_value_completion</span><span class='lparen'>(</span><span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span><span class='id identifier rubyid_param_name'>param_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_param'>param</span> <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span><span class='id identifier rubyid_param'>param</span><span class='op'>|</span>
    <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>==</span> <span class='id identifier rubyid_param_name'>param_name</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_param'>param</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_param'>param</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span>
    <span class='kw'>when</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Params</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>Boolean</span>
      <span class='qwords_beg'>%w[</span><span class='tstring_content'>true</span><span class='words_sep'> </span><span class='tstring_content'>false</span><span class='words_sep'> </span><span class='tstring_content'>yes</span><span class='words_sep'> </span><span class='tstring_content'>no</span><span class='tstring_end'>]</span></span>
    <span class='kw'>when</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Params</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>Enum</span>
      <span class='id identifier rubyid_param'>param</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload-instance_method">
  
    #<strong>payload</strong>(payload_name)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


84
85
86
87
88
89
90
91
92
93
94
95
96</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/exploits/cli/exploit_shell.rb', line 84</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload'>payload</span><span class='lparen'>(</span><span class='id identifier rubyid_payload_name'>payload_name</span><span class='rparen'>)</span>
  <span class='ivar'>@payload_class</span> <span class='op'>=</span> <span class='const'>Payloads</span><span class='period'>.</span><span class='id identifier rubyid_load_class'>load_class</span><span class='lparen'>(</span><span class='id identifier rubyid_payload_name'>payload_name</span><span class='rparen'>)</span>
  <span class='ivar'>@payload</span>       <span class='op'>=</span> <span class='ivar'>@payload_class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='kw'>if</span> <span class='ivar'>@exploit</span>
    <span class='kw'>begin</span>
      <span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_payload'>payload</span> <span class='op'>=</span> <span class='ivar'>@payload</span>
    <span class='kw'>rescue</span> <span class='const'><span class='object_link'><a href="../IncompatiblePayload.html" title="Ronin::Exploits::IncompatiblePayload (class)">IncompatiblePayload</a></span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
      <span class='id identifier rubyid_print_error'>print_error</span><span class='lparen'>(</span><span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='kw'>false</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload_completion-instance_method">
  
    #<strong>payload_completion</strong>(arg, preposing)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


98
99
100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/exploits/cli/exploit_shell.rb', line 98</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_completion'>payload_completion</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span><span class='id identifier rubyid_preposing'>preposing</span><span class='rparen'>)</span>
  <span class='const'>Payloads</span><span class='period'>.</span><span class='id identifier rubyid_list_files'>list_files</span> <span class='op'>+</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>-f</span><span class='words_sep'> </span><span class='tstring_content'>--file</span><span class='tstring_end'>]</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="run-instance_method">
  
    #<strong>run</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/exploits/cli/exploit_shell.rb', line 335</span>

<span class='kw'>def</span> <span class='id identifier rubyid_run'>run</span>
  <span class='kw'>unless</span> <span class='ivar'>@exploit</span>
    <span class='id identifier rubyid_no_exploit!'>no_exploit!</span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='kw'>begin</span>
    <span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_validate'>validate</span>
  <span class='kw'>rescue</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Params</span><span class='op'>::</span><span class='const'>ParamError</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../ValidationError.html" title="Ronin::Exploits::ValidationError (class)">ValidationError</a></span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
    <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>run: cannot run exploit </span><span class='embexpr_beg'>#{</span><span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_class_id'>class_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
    <span class='id identifier rubyid_print_exception'>print_exception</span><span class='lparen'>(</span><span class='id identifier rubyid_error'>error</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>run: an unhandled exception occurred while validating the exploit </span><span class='embexpr_beg'>#{</span><span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_class_id'>class_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='kw'>begin</span>
    <span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_exploit'>exploit</span>
  <span class='kw'>rescue</span> <span class='const'><span class='object_link'><a href="../ExploitError.html" title="Ronin::Exploits::ExploitError (class)">ExploitError</a></span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
    <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>run: failed to run exploit </span><span class='embexpr_beg'>#{</span><span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_class_id'>class_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
    <span class='id identifier rubyid_print_exception'>print_exception</span><span class='lparen'>(</span><span class='id identifier rubyid_error'>error</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>run: an unhandled exception occurred while running the exploit </span><span class='embexpr_beg'>#{</span><span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_class_id'>class_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set-instance_method">
  
    #<strong>set</strong>(name, value)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/exploits/cli/exploit_shell.rb', line 106</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set'>set</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='ivar'>@exploit</span>
    <span class='id identifier rubyid_no_exploit!'>no_exploit!</span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='kw'>begin</span>
    <span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_set_param'>set_param</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Params</span><span class='op'>::</span><span class='const'>ParamError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
    <span class='id identifier rubyid_print_error'>print_error</span><span class='lparen'>(</span><span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
    <span class='id identifier rubyid_print_exception'>print_exception</span><span class='lparen'>(</span><span class='id identifier rubyid_error'>error</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>an unhandled exception occurred while setting param </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> on exploit </span><span class='embexpr_beg'>#{</span><span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_class_id'>class_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_completion-instance_method">
  
    #<strong>set_completion</strong>(arg, preposing)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126
127
128
129
130
131
132
133
134
135
136
137
138
139</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/exploits/cli/exploit_shell.rb', line 126</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_completion'>set_completion</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span><span class='id identifier rubyid_preposing'>preposing</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_match'>match</span> <span class='op'>=</span> <span class='id identifier rubyid_preposing'>preposing</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\Aset\s+(\w+)\s+\z</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_param_name'>param_name</span> <span class='op'>=</span> <span class='id identifier rubyid_match'>match</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>

    <span class='kw'>if</span> <span class='ivar'>@exploit_class</span>
      <span class='id identifier rubyid_param_value_completion'>param_value_completion</span><span class='lparen'>(</span><span class='ivar'>@exploit_class</span><span class='comma'>,</span><span class='id identifier rubyid_param_name'>param_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='id identifier rubyid_match'>match</span> <span class='op'>=</span> <span class='id identifier rubyid_preposing'>preposing</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\Aset\s+\w+\z</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># param name completion
</span>    <span class='kw'>if</span> <span class='ivar'>@exploit_class</span>
      <span class='id identifier rubyid_param_name_completion'>param_name_completion</span><span class='lparen'>(</span><span class='ivar'>@exploit_class</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="target-instance_method">
  
    #<strong>target</strong>(*args)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/exploits/cli/exploit_shell.rb', line 168</span>

<span class='kw'>def</span> <span class='id identifier rubyid_target'>target</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='ivar'>@exploit</span>
    <span class='id identifier rubyid_no_exploit!'>no_exploit!</span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='kw'>unless</span> <span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Mixins.html" title="Ronin::Exploits::Mixins (module)">Mixins</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Mixins/HasTargets.html" title="Ronin::Exploits::Mixins::HasTargets (module)">HasTargets</a></span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>target: exploit </span><span class='embexpr_beg'>#{</span><span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_class_id'>class_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> does not support targets</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_target_kwargs'>target_kwargs</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='id identifier rubyid_option_parser'>option_parser</span> <span class='op'>=</span> <span class='const'>OptionParser</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_opts'>opts</span><span class='op'>|</span>
    <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_banner'>banner</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>usage: target [ID | options]</span><span class='tstring_end'>&#39;</span></span>

    <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_on'>on</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-A</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--arch</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="#ARCHES-constant" title="Ronin::Exploits::CLI::ExploitShell::ARCHES (constant)">ARCHES</a></span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Targets the architecture</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arch'>arch</span><span class='op'>|</span>
      <span class='id identifier rubyid_target_kwargs'>target_kwargs</span><span class='lbracket'>[</span><span class='symbol'>:arch</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_arch'>arch</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_on'>on</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-O</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--os</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="#OSES-constant" title="Ronin::Exploits::CLI::ExploitShell::OSES (constant)">OSES</a></span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Targets the Operating System (OS)</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_os'>os</span><span class='op'>|</span>
      <span class='id identifier rubyid_target_kwargs'>target_kwargs</span><span class='lbracket'>[</span><span class='symbol'>:os</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_os'>os</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_on'>on</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--os-version VERSION</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='const'>String</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Targets the Operating System (OS) version</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_version'>version</span><span class='op'>|</span>
      <span class='id identifier rubyid_target_kwargs'>target_kwargs</span><span class='lbracket'>[</span><span class='symbol'>:os_version</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_version'>version</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_on'>on</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-S</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--software NAME</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='const'>String</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Targets the software</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span>
      <span class='id identifier rubyid_target_kwargs'>target_kwargs</span><span class='lbracket'>[</span><span class='symbol'>:software</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_on'>on</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-V</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--software-version VERSION</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='const'>String</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Targets the software version</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_version'>version</span><span class='op'>|</span>
      <span class='id identifier rubyid_target_kwargs'>target_kwargs</span><span class='lbracket'>[</span><span class='symbol'>:software_version</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_version'>version</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_on'>on</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-h</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--help</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Print options</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_opts'>opts</span>
      <span class='kw'>return</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='kw'>begin</span>
           <span class='id identifier rubyid_option_parser'>option_parser</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
         <span class='kw'>rescue</span> <span class='const'>OptionParser</span><span class='op'>::</span><span class='const'>ParseError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
           <span class='id identifier rubyid_print_error'>print_error</span> <span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
           <span class='kw'>return</span> <span class='kw'>false</span>
         <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_target_kwargs'>target_kwargs</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>target: must specify ID or options</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>elsif</span> <span class='op'>!</span><span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_target_kwargs'>target_kwargs</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>target: must specify either an ID or options, not both</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>1</span>
    <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>target: too many arguments specified</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_id'>id</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A\d+\z</span><span class='regexp_end'>/</span></span>
      <span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>target: ID must be an integer: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>return</span> <span class='kw'>false</span>
    <span class='kw'>end</span>

    <span class='kw'>begin</span>
      <span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_target'>target</span> <span class='op'>=</span> <span class='id identifier rubyid_id'>id</span>
    <span class='kw'>rescue</span> <span class='const'>NoMatchingTarget</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
      <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>target: cannot set the target: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>return</span> <span class='kw'>false</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='op'>!</span><span class='id identifier rubyid_target_kwargs'>target_kwargs</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='kw'>begin</span>
      <span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_select_target'>select_target</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_target_kwargs'>target_kwargs</span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>NoMatchingTarget</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
      <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>target: no matching targets for: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>return</span> <span class='kw'>false</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="target_completion-instance_method">
  
    #<strong>target_completion</strong>(arg, preposing)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/exploits/cli/exploit_shell.rb', line 252</span>

<span class='kw'>def</span> <span class='id identifier rubyid_target_completion'>target_completion</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span><span class='id identifier rubyid_preposing'>preposing</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_target_attributes'>target_attributes</span> <span class='op'>=</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_attribute'>attribute</span><span class='rparen'>)</span> <span class='tlambeg'>{</span>
    <span class='ivar'>@exploit_class</span><span class='period'>.</span><span class='id identifier rubyid_targets'>targets</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_attribute'>attribute</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
  <span class='rbrace'>}</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_preposing'>preposing</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s+(?:--arch|-A)\s+\z</span><span class='regexp_end'>/</span></span>
    <span class='kw'>if</span> <span class='ivar'>@exploit_class</span>
      <span class='id identifier rubyid_target_attributes'>target_attributes</span><span class='lbracket'>[</span><span class='symbol'>:arch</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_arch'>arch</span><span class='op'>|</span> <span class='const'>ARCH</span><span class='lbracket'>[</span><span class='id identifier rubyid_arch'>arch</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_preposing'>preposing</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s+(?:--os|-O)\s+\z</span><span class='regexp_end'>/</span></span>
    <span class='kw'>if</span> <span class='ivar'>@exploit_class</span>
      <span class='id identifier rubyid_target_attributes'>target_attributes</span><span class='lbracket'>[</span><span class='symbol'>:os</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_preposing'>preposing</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s+--os-version\s+\z</span><span class='regexp_end'>/</span></span>
    <span class='kw'>if</span> <span class='ivar'>@exploit_class</span>
      <span class='id identifier rubyid_target_attributes'>target_attributes</span><span class='lbracket'>[</span><span class='symbol'>:os_version</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_preposing'>preposing</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s+(?:--software|-S)\s+\z</span><span class='regexp_end'>/</span></span>
    <span class='kw'>if</span> <span class='ivar'>@exploit_class</span>
      <span class='id identifier rubyid_target_attributes'>target_attributes</span><span class='lbracket'>[</span><span class='symbol'>:software</span><span class='rbracket'>]</span>
      <span class='ivar'>@exploit_class</span><span class='period'>.</span><span class='id identifier rubyid_targets'>targets</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:software</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_preposing'>preposing</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s+(?:--software-version|-V)\s+\z</span><span class='regexp_end'>/</span></span>
    <span class='kw'>if</span> <span class='ivar'>@exploit_class</span>
      <span class='id identifier rubyid_target_attributes'>target_attributes</span><span class='lbracket'>[</span><span class='symbol'>:software_version</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_values'>values</span> <span class='op'>=</span> <span class='qwords_beg'>%w[</span><span class='words_sep'>
      </span><span class='tstring_content'>-A</span><span class='words_sep'> </span><span class='tstring_content'>--arch</span><span class='words_sep'>
      </span><span class='tstring_content'>-O</span><span class='words_sep'> </span><span class='tstring_content'>--os</span><span class='words_sep'>
      </span><span class='tstring_content'>--os-version</span><span class='words_sep'>
      </span><span class='tstring_content'>-S</span><span class='words_sep'> </span><span class='tstring_content'>--software</span><span class='words_sep'>
      </span><span class='tstring_content'>-V</span><span class='words_sep'> </span><span class='tstring_content'>--software-version</span><span class='words_sep'>
      </span><span class='tstring_content'>-h</span><span class='words_sep'> </span><span class='tstring_content'>--help</span><span class='words_sep'>
    </span><span class='tstring_end'>]</span></span>

    <span class='kw'>if</span> <span class='ivar'>@exploit_class</span>
      <span class='ivar'>@exploit_class</span><span class='period'>.</span><span class='id identifier rubyid_targets'>targets</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
        <span class='id identifier rubyid_values'>values</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_i'>i</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_values'>values</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test-instance_method">
  
    #<strong>test</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/exploits/cli/exploit_shell.rb', line 300</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test'>test</span>
  <span class='kw'>unless</span> <span class='ivar'>@exploit</span>
    <span class='id identifier rubyid_no_exploit!'>no_exploit!</span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='kw'>begin</span>
    <span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_validate'>validate</span>
  <span class='kw'>rescue</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Params</span><span class='op'>::</span><span class='const'>ParamError</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../ValidationError.html" title="Ronin::Exploits::ValidationError (class)">ValidationError</a></span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
    <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>test: cannot test exploit </span><span class='embexpr_beg'>#{</span><span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_class_id'>class_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
    <span class='id identifier rubyid_print_exception'>print_exception</span><span class='lparen'>(</span><span class='id identifier rubyid_error'>error</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>test: an unhandled exception occurred while validating the exploit </span><span class='embexpr_beg'>#{</span><span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_class_id'>class_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_perform_test'>perform_test</span>
  <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_result'>result</span>
           <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../TestResult.html" title="Ronin::Exploits::TestResult (class)">TestResult</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../TestResult/Vulnerable.html" title="Ronin::Exploits::TestResult::Vulnerable (class)">Vulnerable</a></span></span>
             <span class='id identifier rubyid_colors'>colors</span><span class='period'>.</span><span class='id identifier rubyid_red'>red</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Vulnerable:</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
           <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../TestResult.html" title="Ronin::Exploits::TestResult (class)">TestResult</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../TestResult/NotVulnerable.html" title="Ronin::Exploits::TestResult::NotVulnerable (class)">NotVulnerable</a></span></span>
             <span class='id identifier rubyid_colors'>colors</span><span class='period'>.</span><span class='id identifier rubyid_green'>green</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Not Vulnerable:</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
           <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../TestResult.html" title="Ronin::Exploits::TestResult (class)">TestResult</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../TestResult/Unknown.html" title="Ronin::Exploits::TestResult::Unknown (class)">Unknown</a></span></span>
             <span class='id identifier rubyid_colors'>colors</span><span class='period'>.</span><span class='id identifier rubyid_yellow'>yellow</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Unknown:</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
           <span class='kw'>else</span>
             <span class='id identifier rubyid_print_error'>print_error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>test: the test method in exploit </span><span class='embexpr_beg'>#{</span><span class='ivar'>@exploit</span><span class='period'>.</span><span class='id identifier rubyid_class_id'>class_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> returned an unknown test result: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
             <span class='kw'>return</span> <span class='kw'>false</span>
           <span class='kw'>end</span>

  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="use-instance_method">
  
    #<strong>use</strong>(exploit_name)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


60
61
62
63
64
65
66
67
68
69
70
71
72
73
74</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/exploits/cli/exploit_shell.rb', line 60</span>

<span class='kw'>def</span> <span class='id identifier rubyid_use'>use</span><span class='lparen'>(</span><span class='id identifier rubyid_exploit_name'>exploit_name</span><span class='rparen'>)</span>
  <span class='ivar'>@exploit_class</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Exploits.html" title="Ronin::Exploits (module)">Exploits</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load_class'>load_class</span><span class='lparen'>(</span><span class='id identifier rubyid_exploit_name'>exploit_name</span><span class='rparen'>)</span>
  <span class='ivar'>@exploit</span>       <span class='op'>=</span> <span class='kw'>if</span> <span class='ivar'>@exploit_class</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Mixins.html" title="Ronin::Exploits::Mixins (module)">Mixins</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Mixins/HasPayload.html" title="Ronin::Exploits::Mixins::HasPayload (module)">HasPayload</a></span></span><span class='rparen'>)</span>
                     <span class='kw'>begin</span>
                       <span class='ivar'>@exploit_class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='label'>payload:</span> <span class='ivar'>@payload</span><span class='rparen'>)</span>
                     <span class='kw'>rescue</span> <span class='const'><span class='object_link'><a href="../IncompatiblePayload.html" title="Ronin::Exploits::IncompatiblePayload (class)">IncompatiblePayload</a></span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
                       <span class='id identifier rubyid_print_error'>print_error</span><span class='lparen'>(</span><span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
                       <span class='kw'>return</span> <span class='kw'>false</span>
                     <span class='kw'>end</span>
                   <span class='kw'>else</span>
                     <span class='ivar'>@exploit_class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
                   <span class='kw'>end</span>

  <span class='ivar'>@shell_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ronin-exploits(</span><span class='embexpr_beg'>#{</span><span class='ivar'>@exploit_class</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="use_completion-instance_method">
  
    #<strong>use_completion</strong>(arg, preposing)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


76
77
78</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/exploits/cli/exploit_shell.rb', line 76</span>

<span class='kw'>def</span> <span class='id identifier rubyid_use_completion'>use_completion</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span><span class='id identifier rubyid_preposing'>preposing</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="../../Exploits.html" title="Ronin::Exploits (module)">Exploits</a></span></span><span class='period'>.</span><span class='id identifier rubyid_list_files'>list_files</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Jan  9 12:47:55 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.28 (ruby-3.1.3).
</div>

    </div>
  </body>
</html>